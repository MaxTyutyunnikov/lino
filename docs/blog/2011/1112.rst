20111112
========

user-specific language selection
--------------------------------

More details to do for the support of 
user-specific language selection.

:class:`lino.apps.dsbe.models.CefLevel` overrides `display_text`, 
and this method wasn't yet adapted to yesterday's changes.

There were still some places where Lino translates too early: 

- the headers of tabs
- labels of buttons and menus

Worked on the French translations which are far from being 
perfect but start to get usable.

There is one conceptual detail which needed a design decision: 
how to mark **hotkey letters in menu items**.
Until now we had the following temporary solution::

  def prepare_label(mi):
      label = unicode(mi.label) # trigger translation
      n = label.find(mi.HOTKEY_MARKER)
      if n != -1:
          label = label.replace(mi.HOTKEY_MARKER,'')
      return label

This method doesn't work any longer with lazy translation. 
But anyway it wasn't used since lino.ui.extjs3 simply removed the markers.

Listings
--------

Optimizations when printing a :class:`Listing <lino.mixins.printable.Listing>`:

- It didn't use the DavLink applet when 
  :attr:`lino.Lino.use_davlink` was `True`. Fixed.
- It no longer uses a hard-coded site-wide template "Listing.odt" 
  but a `Default.odt` in the model's config directory.

Check-in 20111112b



Traceback (most recent call last):
  File "/var/snapshots/lino/lino/ui/extjs3/ext_ui.py", line 1207, in api_element_view
    return a.run(ar,elem)
  File "/var/snapshots/lino/lino/mixins/printable.py", line 548, in run
    bm.build(self,elem)
  File "/var/snapshots/lino/lino/mixins/printable.py", line 246, in build
    tplfile = find_config_file(tpl_leaf,self.get_group(elem))
  File "/var/snapshots/lino/lino/mixins/printable.py", line 210, in get_group
    return elem.get_templates_group()
AttributeError: 'CourseOffer' object has no attribute 'get_templates_group'

Bug "maximzable"
----------------

There was a useless vertical scrollbar on all windows which 
appeared sometimes and didn't disappeasr. 
The bug didn't reproduce after I added a "maximzable=true" to the 
base Window configuration.

Candidates of a Course : this print action was erroneously moved 
from Course to CourseOffer. Fixed.
