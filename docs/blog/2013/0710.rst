==================================
20130710 (Wednesday, 10 July 2013)
==================================

Inheriting `config` directory of another app
--------------------------------------------

Added a new module :mod:`lino.modlib.auto.sales` 
which extends :mod:`lino.modlib.sales` and
is a next example of what I'd call "app inheritance".

The base `sales` app is for writing sales invoices,
the "auto" sales app is for having Lino automatically 
generate sales invoices.

It works basically like :mod:`lino_faggio.contacts`
(which extends :mod:`lino.modlib.contacts`, see :blogref:`20130607`).

This time there was a new challenge: how can I say that I want 
to "inherit" the document template for Invoices?
The answer is inspired by a technique to extend the Pythonpath:
simply add a file 
:srcref:`config.pth <lino/modlib/auto/sales/config.pth>`
(the name must end with :file:`.pth`) to the app's directory 
(i.e. the directory which contains the :file:`models.py` file).
This file should contain one line for each additional 
`config` dir to add.


Lino-Faggio continued
---------------------

- `lino.modlib.cal.Event` and `lino.modlib.cal.Room` are now 
  overridable.
  
- :mod:`lino_faggio` uses this to make Events invoiceable
- cal.Room is no longer a ContactRelated by default because many 
  applications don't need this. :mod:`lino_faggio` 
  overrides it to make it ContactRelated.
  
- :mod:`lino_faggio` now also adds new fields 
  `Event.organizer`
  `cal.Room.tariff`
  
- New app :mod:`lino_faggio.cal` extends :mod:`lino.modlib.cal`

Inheriting `config` directory of another app (continued)
--------------------------------------------------------

After having checked in the above changes, I understood that we don't 
want an additional file `config.pth`,
it is better to use just a new magic module-level variable `PARENT_APP`:
because that's one file less, and because the 
`config.pth` trick didn't work for making 
:mod:`lino_faggio.cal` inherit the config of :mod:`lino.modlib.cal` 
(because the former cannot easily know the path of the latter).

  
A side effect is that we cannot any longer 
import mod:`lino.utils.config` at the global level of a models module
because importing it will fill the config dirs, i.e. will try to import 
every installed `models` module.

Added new function :func:`lino.dd.extends_app`.
To have :mod:`lino_faggio.cal` extend :mod:`lino.modlib.cal`,
we now need only one line of code::

  dd.extends_app('lino.modlib.sales',globals())
  

Lino-Faggio continued
---------------------

- Renamed `lino.modlib.school` to `lino.modlib.courses`.
- New module :mod:`lino_faggio.courses` extends :mod:`lino.modlib.courses`.
