#21 : LoadMask for Detail windows
=================================


When I doubleclick a  row in a Grid, Lino opens a Detail window for this row.
The problem is that I didn't yet find a way to display a loadMask while 
this window is being built.
And complex windows take some time to render.
And the user is there for several seconds without knowing what's going on.

(For example :class:`lino.modlib.dsbe.models.Person` has a huge FormPanel as main component) 

Here is the code where I think it should happen. 
``Lino.show_detail`` is called by a double click on a GridPanel.

::

  Lino.show_detail = function(panel,btn) {
    Lino.do_on_current_record(panel,
      function(rec) {
        panel.loadMask.show();
        //~ alert('foo');
        panel.ls_detail_handler(panel,{
          record_id:rec.id,base_params:panel.get_base_params()
        });
        panel.loadMask.hide();
      },
      Lino.show_insert
    );
  };
  
``panel.ls_detail_handler`` is the "detail handler" 
configured for this Grid. 
Detail handlers are simple functions that basicalle create 
an :extjs:`Ext.Window` and call `show()` on it. 
Here is a simplified example of a detail handler::

  Lino.contacts.Persons.detail = function(caller,params) { 
    var ww = new Lino.DetailWrapper(caller,...);
    var form_panel1607 = new Lino.contacts.Persons.FormPanel(...);
    ww.main_item = form_panel1607;
    ww.show();
  }



Somebody named end-user 
appearently had the same problem in the following thread:
http://www.sencha.com/forum/showthread.php?26816
But this thread is 3 years old, 
and unfortunately the answers didn't help me.


Interesting observation: 
the loadMask *does* get activated correctly
when I insert a line ``alert('foo')`` before calling the detail handler.


History:

- :doc:`/blog/2011/0218` started this document

