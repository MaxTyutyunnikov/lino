<?xml version="1.0" encoding="latin-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=latin-1" />
<meta name="generator" content="Docutils 0.3.6: http://docutils.sourceforge.net/" />
<title>openmail</title>
<link rel="stylesheet" href="default.css" type="text/css" />
</head>
<body>
<table class="mainTable">
			<tr>
			<td valign="top" class="leftArea">
				<p class="menu">
	<a href="index.html">Home</a>
	<br><a href="http://sourceforge.net/projects/lino/">Forge</a>
	</p>
	
	<p class="copyright">
	&copy; 2001-2004
	<br><a href="mailto:luc.saffre@gmx.net">Luc Saffre</a>
	<br>
	
	<br><a href="http://sourceforge.net">
	<img src="http://sourceforge.net/sflogo.php?group_id=87016&type=1"
   width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
	</p>
	<br>&nbsp;&nbsp;<a href="overview.html">overview</a><br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="adamo/adamo.html">adamo</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="adamo/pizzeria.html">pizzeria</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="adamo/intro.html">intro</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="adamo/tim2adamo.html">tim2adamo</a><br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="timtools.html">timtools</a><br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="wui.html">wui</a><br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="webman.html">webman</a><br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="pds/pds.html">pds</a><br>&nbsp;&nbsp;<a href="faq.html">faq</a><br>&nbsp;&nbsp;<a href="links.html">links</a><br>&nbsp;&nbsp;<a href="install.html">install</a><br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="start.html">start</a><br>&nbsp;&nbsp;<a href="history.html">history</a></td>
			<td class="textArea"><h1 class="title">openmail</h1>
<div class="document" id="openmail">
<p><cite>Lino openmail</cite> invokes the user's default mail client with a
ready-to-send message.</p>
<div class="section" id="usage">
<h1><a name="usage">Usage</a></h1>
<p>Before calling <cite>openmail</cite> you must write the contents of your message
to a temporary file, using a simplified pseudo-<a class="reference" href="http://www.faqs.org/rfcs/rfc2822.html">RFC2822</a> format.</p>
<p>Usage example:</p>
<ol class="arabic">
<li><p class="first">Create a file TMP.EML with the following content:</p>
<pre class="literal-block">
To: user&#64;isp.com
Subject: Kontoauszug

Sehr geehrter Kunde!

Wir erlauben uns, Sie auf folgende, noch
ausstehende Rechnungen aufmerksam zu machen :

...

Mit freundlichen Grüßen
</pre>
<p>Note: if the file contains non-ASCII characters, it should be
cp850 encoded.</p>
</li>
<li><p class="first">At the command line, type:</p>
<pre class="literal-block">
lino openmail TMP.EML
</pre>
</li>
</ol>
</div>
<div class="section" id="how-openmail-does-it">
<h1><a name="how-openmail-does-it">How openmail does it</a></h1>
<p>openmail reads the specified file, then constructs a <cite>mailto:</cite> link
and launches the default web browser with this URL.</p>
<p>So the result is the same as clicking on a &quot;mailto&quot; link.  The browser
is responsible for invoking the mail client correctly.  And the user
for configuring her browser so that &quot;mailto:&quot; links work.</p>
<p>Test: 
Does your browser invoke your e-mail client correctly?</p>
<ul class="simple">
<li><a class="reference" href="mailto:Fritz%20Eierschale%20&amp;lt;eierschale&#64;irgend.wo&amp;gt;?subject=eine%20Mail%20von%20deinen%20Web-Seiten?body=Hallo%20Fritz,%0D%0A%0D%0Aich%20wollte%20nur%20sagen,%20da%DF&quot;">first</a></li>
</ul>
<p>The subject is quite complex, and it is likely that openmail does not
work out of the box.  Don't hesitate to contact me.</p>
<p>Sources of information:</p>
<ul class="simple">
<li><a class="reference" href="http://www.faqs.org/rfcs/rfc2368.html">http://www.faqs.org/rfcs/rfc2368.html</a> :
The mailto URL scheme</li>
<li><a class="reference" href="http://selfhtml.teamone.de/html/verweise/email.htm">http://selfhtml.teamone.de/html/verweise/email.htm</a>:
comprehensive description of mailto URLs</li>
<li><a class="reference" href="http://www.ianr.unl.edu/internet/mailto.html">http://www.ianr.unl.edu/internet/mailto.html</a> states that
multiline-bodies must be specified using multiple &quot;body=&quot;
attributes. (But &quot;This feature will NOT work with all e-mail
programs, in which case the body information appears as a single
line.&quot;)</li>
</ul>
<p><strong>Alternative approaches</strong> (instead of using the mailto link) could
be:</p>
<ul>
<li><p class="first">launch the mail client directly, but this would involve writing
&quot;drivers&quot; for every supported mail client.</p>
</li>
<li><p class="first">starting an <cite>*.eml</cite> file on Windows will invoke Outlook with the
expected behaviour... except that the message is not editable for
further reviewing before sending it.</p>
<p>Mozilla seems to not be able to handle <cite>*.eml</cite> files:
<a class="reference" href="http://bugzilla.mozilla.org/show_bug.cgi?id=11076">http://bugzilla.mozilla.org/show_bug.cgi?id=11076</a></p>
</li>
</ul>
</div>
<div class="section" id="setting-the-default-browser">
<h1><a name="setting-the-default-browser">Setting the default browser</a></h1>
<p>The windows registry key:</p>
<pre class="literal-block">
HKEY_CLASSES_ROOT\mailto\shell\open\command
</pre>
<p>should contain:</p>
<pre class="literal-block">
rundll32.exe url.dll,MailToProtocolHandler %1
</pre>
<ul class="simple">
<li>C:Programmemozilla.orgMozillamozilla.exe -browser &quot;mailto:%1&quot;</li>
<li>C:PROGRA~1QualcommEudoraEudora.exe /m %1
<tt class="literal"><span class="pre">ForceDDEForHandlingMailto=1</span></tt> in <cite>[Settings]</cite> section of
<cite>eudora.ini</cite>.</li>
<li><a class="reference" href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;154359">http://support.microsoft.com/default.aspx?scid=kb;EN-US;154359</a> 
How to Change Default Mail Client for Internet Explorer</li>
<li><a class="reference" href="http://home.att.net/~cherokee67/eudoradefault.html">http://home.att.net/~cherokee67/eudoradefault.html</a></li>
<li><a class="reference" href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;149617">http://support.microsoft.com/default.aspx?scid=kb;EN-US;149617</a>:
Eudora Changes Default MailTo Handler</li>
<li><a class="reference" href="http://members.toast.net/4pf/Protocol.html">http://members.toast.net/4pf/Protocol.html</a>: &quot;Internet Explorer
(version 6, anyway) uses Windows Messaging by default to invoke a
mailer on a mailto: link. Only if the MAPI install is misconfigured
will it resort to directly accessing the mailto association key.&quot;</li>
</ul>
</div>
</div>
</td></tr></table></body>
</html>
<div class="bottomArea"><p class="footer">This page was generated on Fri Sep 24 12:55:03 2004 by Lino <a href="webman.html">WebMan</a> version 0.6.2pre.</div>